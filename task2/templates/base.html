<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Inventory Management System{% endblock %}</title>
    <meta name="theme-color" content="#696cff">
    <!-- Preload theme as early as possible to avoid FOUC -->
    <script>
      (function () {
        try {
          var saved = localStorage.getItem('theme');
          var prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          var theme = saved || (prefersDark ? 'dark' : 'light');
          document.documentElement.setAttribute('data-theme', theme);
        } catch (e) {}
      })();
    </script>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <!-- Google Font: Public Sans (Sneat default) -->
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        /* Sneat-inspired design system with Bootstrap variable overrides */
        :root,
        :root[data-theme="light"],
        [data-theme="light"] {
          /* Bootstrap palette overrides */
          --bs-primary: #696cff; /* Sneat indigo */
          --bs-primary-rgb: 105,108,255;
          --bs-secondary: #8592a3;
          --bs-success: #71dd37;
          --bs-info: #03c3ec;
          --bs-warning: #ffab00;
          --bs-danger: #ff3e1d;
          --bs-light: #f5f5f9;
          --bs-dark: #233446;

          /* Base surface tokens */
          --ui-body-bg: #f5f5f9;
          --ui-content-bg: #ffffff;
          --ui-text: #4b4b4b;
          --ui-muted: #667085;
          --ui-border: #e6e6f2;
          --ui-card-shadow: 0 2px 6px rgba(76, 87, 125, 0.06), 0 10px 20px rgba(76, 87, 125, 0.04);
        }

        :root[data-theme="dark"],
        [data-theme="dark"] {
          --bs-primary: #696cff;
          --bs-primary-rgb: 105,108,255;
          --bs-secondary: #9da8b7;
          --bs-success: #71dd37;
          --bs-info: #29d6ff;
          --bs-warning: #ffcf5c;
          --bs-danger: #ff6b56;
          --bs-light: #2b2c40;
          --bs-dark: #151521;

          --ui-body-bg: #101223;
          --ui-content-bg: #1b1f32;
          --ui-text: #e2e6ee;
          --ui-muted: #a5adbf;
          --ui-border: #2d3350;
          --ui-card-shadow: 0 2px 6px rgba(0,0,0,0.35), 0 10px 20px rgba(0,0,0,0.25);
        }

        body {
          background-color: var(--ui-body-bg);
          color: var(--ui-text);
          font-family: 'Public Sans', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
          line-height: 1.6;
        }

        /* Navbar */
        .navbar {
          background-color: var(--ui-content-bg) !important;
          border-bottom: 1px solid var(--ui-border);
          box-shadow: var(--ui-card-shadow);
        }
        .navbar .navbar-brand,
        .navbar .nav-link,
        .navbar .navbar-text { color: var(--ui-text) !important; }
        .navbar .nav-link:hover { color: var(--bs-primary) !important; }
        .navbar .navbar-toggler { color: var(--ui-text); border-color: var(--ui-border); }
        .navbar .navbar-toggler-icon {
          background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='currentColor' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        }

        .navbar-brand {
          font-weight: 700;
          font-size: 1.25rem;
          letter-spacing: .2px;
        }

        /* Cards */
        .card {
          background: var(--ui-content-bg);
          color: var(--ui-text);
          border: 1px solid var(--ui-border);
          border-radius: 0.75rem;
          box-shadow: var(--ui-card-shadow);
          transition: transform .2s ease, box-shadow .2s ease;
        }
        .card:hover { transform: translateY(-2px); }
        .card-header { border-bottom: 1px solid var(--ui-border); background: transparent; }

        /* Buttons */
        .btn { border-radius: 0.6rem; font-weight: 600; letter-spacing: .2px; }
        .btn-primary { background-color: var(--bs-primary); border-color: var(--bs-primary); }
        .btn-outline-light { border-color: rgba(255,255,255,.3); }

        /* Tables */
        .table { color: inherit; }
        .table thead th {
          background: rgba(var(--bs-primary-rgb), .08);
          color: var(--ui-text);
          border-bottom-color: var(--ui-border);
          font-weight: 700;
        }
        .table tbody tr { border-color: var(--ui-border); }

        /* Forms */
        .form-control, .form-select {
          color: inherit;
          background: var(--ui-content-bg);
          border: 1px solid var(--ui-border);
          border-radius: .6rem;
        }
        .form-control:focus, .form-select:focus {
          border-color: rgba(var(--bs-primary-rgb), .7);
          box-shadow: 0 0 0 .2rem rgba(var(--bs-primary-rgb), .15);
        }

        /* Alerts */
        .alert { border-radius: .7rem; border: 1px solid var(--ui-border); }

        /* Hero */
        .hero-section {
          background: linear-gradient(135deg, rgba(var(--bs-primary-rgb), .95), rgba(var(--bs-primary-rgb), .75));
          color: #fff;
          padding: 56px 0;
          margin-bottom: 32px;
        }

        /* Stats */
        .stats-card {
          background: var(--ui-content-bg);
          border: 1px solid var(--ui-border);
          border-radius: .75rem;
          padding: 24px;
          text-align: center;
        }
        .stats-number { font-size: 2.25rem; font-weight: 800; color: var(--bs-primary); }
        .stats-label { color: var(--ui-muted); font-weight: 500; }
        .feature-icon { font-size: 2.25rem; color: var(--bs-primary); }

        /* Footer */
        .app-footer { background: var(--ui-content-bg); color: var(--ui-text); border-top: 1px solid var(--ui-border); }

        /* Utility */
        .content-wrapper { padding: 24px 0; }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('index') }}">
                <i class="bi bi-boxes"></i> Inventory Pro
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('index') }}">
                            <i class="bi bi-house"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('products') }}">
                            <i class="bi bi-box"></i> Products
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('locations') }}">
                            <i class="bi bi-geo-alt"></i> Locations
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('movements') }}">
                            <i class="bi bi-arrow-left-right"></i> Movements
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('balance_report') }}">
                            <i class="bi bi-bar-chart"></i> Balance Report
                        </a>
                    </li>
                </ul>
                <div class="d-flex align-items-center gap-2">
                    <button id="themeToggle" class="btn btn-sm btn-outline-secondary" type="button" aria-label="Toggle theme">
                        <i class="bi bi-moon-stars" id="themeIcon"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="container mt-3">
                {% for category, message in messages %}
                    <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">
                        <i class="bi bi-{{ 'exclamation-triangle' if category == 'error' else 'check-circle' if category == 'success' else 'info-circle' }}"></i>
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <!-- Main Content -->
    <main>
        <div class="content-wrapper">
            {% block content %}{% endblock %}
        </div>
    </main>

    <!-- Footer -->
    <footer class="app-footer py-4 mt-5">
        <div class="container text-center">
            <p>&copy; 2025 Inventory Management</p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      (function () {
        var btn = document.getElementById('themeToggle');
        var icon = document.getElementById('themeIcon');
        function applyIcon(theme) {
          if (!icon) return;
          icon.className = theme === 'dark' ? 'bi bi-sun' : 'bi bi-moon-stars';
        }
        function setTheme(theme) {
          document.documentElement.setAttribute('data-theme', theme);
          try { localStorage.setItem('theme', theme); } catch (e) {}
          applyIcon(theme);
        }
        // Initialize icon based on current theme
        var current = document.documentElement.getAttribute('data-theme') || 'light';
        applyIcon(current);
        if (btn) {
          btn.addEventListener('click', function () {
            var next = (document.documentElement.getAttribute('data-theme') === 'dark') ? 'light' : 'dark';
            setTheme(next);
          });
        }
      })();
    </script>
    
    {% block scripts %}{% endblock %}
</body>
</html>
